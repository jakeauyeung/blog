---
layout: post
title:  "字符串转换json的一列操作"
date:   2014-04-24 18:00:58
categories: update
---

####场景

同事丢来一大串字符串，要求转换成json

```
ff1620448f2ae77873cbc1743e00b249,-1;f37d193c6848cdb70921abfbf983a390,-1;f025452ca2692fc63c1f4411cd515e69,-1;5f0da888053a4ae85e304db1c315615e,-1;edd92c3cb502294ac9c83b8730edc5e2,-1;dc57364d4af6904b3f28cc9ba58cd59d,-1;c2f7169ee51b8d7e8ef486dc52396f39,1;b82986e05c4a8b9cb5d338f970b848f9,-1;a2e4f3d1f0de974c1d782fa7760510ff,-1;956646e30c796b054564aeea567cd450,0;8f89399c153f292db5c71178eff5a880,1;c3819f554f60945abe3256064d7cbbfa,-1;899ad1fc3480ca15b8ce8c187296fd6e,-1;a5cc55c2106afa20749da2705eaa29c5,-1;7eaf0cc98347551c8222744ba4b86109,-1;d6d6914e1b8aebe6c78a99372ddf23cf,-1;254a6187e3a01e7f4fc8e3e3ec3dd7e1,-1;5824bb260f846eeab63dfd0612ea2da4,-1;f555520fbf5234760602384c900e2f5d,1;01a2123b45b9b8b2a4196130d2dad79a,-1;0f3068de5ef269c6a7e3ed0e160804d4,-1;0a60be5a2dc124890a482f07552dbf78,1;3da5d1912c823b8c177053327d0d89be,-1;03901b654946aa9ffb06c1ce4580e109,-1;610badc642747d1c1c812f779d70bcc0,-1;c57a5b46a9355abe56170527418c3a0e,-1;9728f765ba7562445b1397808e400fac,-1;3e278f7faa2165a0c8ff0d0393abb852,1;7346595c9dc5d3c038fed07c661ba21d,-1
```
要求格式：{"ff1620448f2ae77873cbc1743e00b249":"-1"}

####解决

```
var _string = 'ff1620448f2ae77873cbc1743e00b249,-1;f37d193c6848cdb70921abfbf983a390,-1;f025452ca2692fc63c1f4411cd515e69,-1;5f0da888053a4ae85e304db1c315615e,-1;edd92c3cb502294ac9c83b8730edc5e2,-1;dc57364d4af6904b3f28cc9ba58cd59d,-1;c2f7169ee51b8d7e8ef486dc52396f39,1;b82986e05c4a8b9cb5d338f970b848f9,-1;a2e4f3d1f0de974c1d782fa7760510ff,-1;956646e30c796b054564aeea567cd450,0;8f89399c153f292db5c71178eff5a880,1;c3819f554f60945abe3256064d7cbbfa,-1;899ad1fc3480ca15b8ce8c187296fd6e,-1;a5cc55c2106afa20749da2705eaa29c5,-1;7eaf0cc98347551c8222744ba4b86109,-1;d6d6914e1b8aebe6c78a99372ddf23cf,-1;254a6187e3a01e7f4fc8e3e3ec3dd7e1,-1;5824bb260f846eeab63dfd0612ea2da4,-1;f555520fbf5234760602384c900e2f5d,1;01a2123b45b9b8b2a4196130d2dad79a,-1;0f3068de5ef269c6a7e3ed0e160804d4,-1;0a60be5a2dc124890a482f07552dbf78,1;3da5d1912c823b8c177053327d0d89be,-1;03901b654946aa9ffb06c1ce4580e109,-1;610badc642747d1c1c812f779d70bcc0,-1;c57a5b46a9355abe56170527418c3a0e,-1;9728f765ba7562445b1397808e400fac,-1;3e278f7faa2165a0c8ff0d0393abb852,1;7346595c9dc5d3c038fed07c661ba21d,-1'
```

es5操作数组方式：

```
var _json = _string.split(';').reduce(function(o,v){var s = v.split(',');o[s[0]]=s[1];return o},{});
console.log(_json);
```

正则替换方式：

```
var _json = JSON.parse('{"' + _string.replace(/,/g, '":"').replace(/;/g, '","') + '"}');
console.log(_json);
````

遍历个数：

```
function getJsonLength(jsonData){
    var _jsonLength = 0;
    for (var item in jsonData){
      _jsonLength++
    }
    return _jsonLength;
  }
  console.log(getJsonLength(_json));
```